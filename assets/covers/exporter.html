<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SVG 批量导出 PNG（1080x1440）</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; padding:24px; color:#111827;}
    h1{font-size:20px; margin:0 0 16px;}
    .card{border:1px solid #e5e7eb; border-radius:12px; padding:16px; margin-bottom:12px;}
    .row{display:flex; align-items:center; justify-content:space-between; gap:12px;}
    .path{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size:12px; color:#374151}
    button{padding:10px 14px; border-radius:10px; border:1px solid #cbd5e1; background:#f8fafc; cursor:pointer}
    button:hover{background:#f1f5f9}
    .hint{color:#6b7280; font-size:12px; margin-top:8px}
  </style>
</head>
<body>
  <h1>SVG 批量导出 PNG（1080x1440）</h1>
  <div class="hint">用法：直接用浏览器打开本文件，然后点击导出按钮；导出的 PNG 将下载到本地。</div>
  <div id="list"></div>

  <script>
    const entries = [
      { name: 'holatiger-overview-cover', svg: 'holatiger-overview-cover.svg' },
      { name: 'tinypass-cover', svg: 'tinypass-cover.svg' },
      { name: 'webdavy-cover', svg: 'webdavy-cover.svg' },
      { name: 'svg-studio-cover', svg: 'svg-studio-cover.svg' },
    ];

    const WIDTH = 1080, HEIGHT = 1440;

    async function fetchText(path){
      const res = await fetch(path);
      if(!res.ok) throw new Error('加载失败: '+path);
      return await res.text();
    }

    async function exportOne(svgPath, outName){
      const svgText = await fetchText(svgPath);
      // 确保 SVG 具有尺寸
      let text = svgText
        .replace('<svg ', `<svg width="${WIDTH}" height="${HEIGHT}" `)
        .replace('xmlns="http://www.w3.org/2000/svg"', 'xmlns="http://www.w3.org/2000/svg"')
        .replace('xmlns:xlink', 'xmlns:xlink');

      const blob = new Blob([text], { type: 'image/svg+xml;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const img = new Image();
      img.onload = () => {
        const canvas = document.createElement('canvas');
        canvas.width = WIDTH; canvas.height = HEIGHT;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, WIDTH, HEIGHT);
        URL.revokeObjectURL(url);
        canvas.toBlob((pngBlob)=>{
          const a = document.createElement('a');
          a.download = `${outName}.png`;
          a.href = URL.createObjectURL(pngBlob);
          a.click();
          setTimeout(()=>URL.revokeObjectURL(a.href), 1000);
        }, 'image/png');
      };
      img.onerror = (e)=>{
        alert('渲染失败: '+svgPath+'\n'+e);
      };
      img.src = url;
    }

    function renderList(){
      const l = document.getElementById('list');
      entries.forEach(e=>{
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="row">
            <div>
              <div><strong>${e.name}</strong></div>
              <div class="path">assets/covers/${e.svg}</div>
            </div>
            <div>
              <button data-name="${e.name}" data-path="${e.svg}">导出 PNG</button>
            </div>
          </div>
        `;
        l.appendChild(card);
      });

      l.addEventListener('click', (ev)=>{
        const btn = ev.target.closest('button');
        if(!btn) return;
        const p = btn.getAttribute('data-path');
        const n = btn.getAttribute('data-name');
        exportOne(p, n).catch(err=>alert(err.message));
      });
    }

    renderList();
  </script>
</body>
</html> 